<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Images</title>
<style>
* { box-sizing: border-box; }
body {
  margin: 0;
  min-height: 100vh;
  background: #0f0f0f;
  color: #eaeaea;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  background: #1a1a1a;
  padding: 30px;
  border-radius: 12px;
  width: 90%;
  max-width: 500px;
  box-shadow: 0 0 20px rgba(0,0,0,0.6);
  text-align: center;
}
h1 { margin-bottom: 20px; }
input, textarea, button {
  width: 100%;
  margin: 8px 0;
  padding: 12px;
  border-radius: 6px;
  border: none;
  font-size: 15px;
}
textarea {
  height: 150px;
  resize: none;
}
input, textarea {
  background: #2a2a2a;
  color: #fff;
}
button {
  background: #3a86ff;
  color: #fff;
  cursor: pointer;
}
button:hover {
  background: #5a9bff;
}
.result {
  margin-top: 15px;
  word-break: break-all;
  font-size: 13px;
}
.preview {
  margin-top: 20px;
  max-width: 100%;
  background: #fff;
  border-radius: 6px;
}
</style>
</head>
<body>

<div class="container" id="app">
  <h1>SVG URL Generator</h1>

  <textarea id="svgText" placeholder="Paste SVG code here..."></textarea>
  <input type="file" id="svgFile" accept=".svg">
  <button onclick="generate()">Generate URL</button>

  <div class="result" id="result"></div>
  <img id="preview" class="preview">
</div>

<script>
function toBase64UTF8(str) {
  return btoa(unescape(encodeURIComponent(str)));
}

function generate() {
  const text = document.getElementById('svgText').value.trim();
  const file = document.getElementById('svgFile').files[0];

  if (!text && !file) {
    alert("Please paste SVG or upload a file.");
    return;
  }

  if (file) {
    const reader = new FileReader();
    reader.onload = e => build(e.target.result);
    reader.readAsText(file, "UTF-8");
  } else {
    build(text);
  }
}

function build(svg) {
  const base64 = toBase64UTF8(svg);
  const encoded = encodeURIComponent(base64);
  const url = `${location.origin}${location.pathname}?=${encoded}`;

  document.getElementById('result').innerHTML =
    `<a href="${url}" target="_blank" style="color:#3a86ff">${url}</a>`;

  document.getElementById('preview').src =
    `data:image/svg+xml;base64,${base64}`;
}

// Auto render when opening with ?=
window.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(location.search);
  const data = params.get("");

  if (data) {
    const base64 = decodeURIComponent(data); // ⭐ 關鍵！
    document.body.innerHTML = "";
    const img = document.createElement("img");
    img.src = `data:image/svg+xml;base64,${base64}`;
    img.style.maxWidth = "100%";
    img.style.display = "block";
    img.style.margin = "20px auto";
    document.body.appendChild(img);
  }
});
</script>

</body>
</html>
